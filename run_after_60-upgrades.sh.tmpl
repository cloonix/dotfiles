{{ if lookPath "brew" -}}
#!/usr/bin/env bash
{{ template "helpers.sh" . }}

section "Upgrades"

# Ensure Homebrew is in PATH if installed
setup_brew_path

{{ if lookPath "brew" -}}
progress "Upgrading Homebrew packages"
if brew upgrade >/dev/null 2>&1; then
    finish
else
    failed
    exit 1
fi

progress "Removing unused dependencies"
if brew autoremove >/dev/null 2>&1; then
    finish
else
    failed
    exit 1
fi

progress "Cleaning up old versions and cache"
if brew cleanup -s >/dev/null 2>&1; then
    finish
else
    failed
    exit 1
fi
{{ end -}}

{{ end -}}
