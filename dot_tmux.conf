# vi mode
setw -g mode-keys vi
set -g status-keys vi

# Home/End key passthrough
bind -n Home send-key C-a
bind -n End send-key C-e

# General
set -g history-limit 50000
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
set -g focus-events on

# True color + extended keys + clipboard (OSC 52)
set -g default-terminal "tmux-256color"
set -g allow-passthrough on
set -s set-clipboard on
# Use 'set' not 'set -as' to avoid duplicating entries on every config reload
set -g terminal-features 'xterm*:Tc:extkeys:clipboard'
# Fix box-drawing characters rendered as 'x'
set -g terminal-overrides 'xterm*:enacs@:smacs@:rmacs@:acsc@'

# Mouse support
set -g mouse on

# Pane display
set -g display-panes-time 4000
set -g display-panes-colour 'yellow'
set -g display-panes-active-colour 'green'

# Extended keys passthrough (Shift+Enter, Ctrl+Enter, etc.)
set -s extended-keys on

# Reload config
unbind r
bind r source-file ~/.tmux.conf \; display-message "Config reloaded"

# Toggle synchronize-panes
bind y set-window-option synchronize-panes \; display-message "synchronize-panes is now #{?pane_synchronized,on,off}"

# Plugins
# https://github.com/tmux-plugins/tpm — plugin manager
set -g @plugin 'tmux-plugins/tpm'
# https://github.com/tmux-plugins/tmux-sensible — sensible defaults everyone can agree on
set -g @plugin 'tmux-plugins/tmux-sensible'
# https://github.com/wfxr/tmux-power — powerline-style status bar theme
set -g @plugin 'wfxr/tmux-power'
# https://github.com/tmux-plugins/tmux-resurrect — save and restore sessions across restarts
set -g @plugin 'tmux-plugins/tmux-resurrect'
# https://github.com/tmux-plugins/tmux-continuum — automatic periodic saving and restore on start
set -g @plugin 'tmux-plugins/tmux-continuum'
# https://github.com/tmux-plugins/tmux-yank — copy to system clipboard in copy mode
set -g @plugin 'tmux-plugins/tmux-yank'
# https://github.com/tmux-plugins/tmux-open — open files and URLs from copy mode with o/^o
set -g @plugin 'tmux-plugins/tmux-open'
# https://github.com/christoomey/vim-tmux-navigator — seamless pane navigation between tmux and vim
set -g @plugin 'christoomey/vim-tmux-navigator'
# https://github.com/tmux-plugins/tmux-sessionist — session management shortcuts (new, kill, switch)
set -g @plugin 'tmux-plugins/tmux-sessionist'
# https://github.com/tmux-plugins/tmux-pain-control — consistent pane splitting and resizing bindings
set -g @plugin 'tmux-plugins/tmux-pain-control'

# tmux-power theme
set -g @tmux_power_theme 'gold'

# tmux-resurrect: use S/R for save/restore
set -g @resurrect-save 'S'
set -g @resurrect-restore 'R'

# tmux-continuum: auto-save every 15 min, restore on start
set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'

# Initialize TPM (keep at bottom)
run '~/.tmux/plugins/tpm/tpm'

# Override escape-time after tmux-sensible resets it to 500
set -s escape-time 0
